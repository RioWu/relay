# 信息门户爬虫文档

​	信息门户使用的是**集中式认证服务**（英语：Central Authentication Service，缩写**CAS**)来做用户认证和单点登陆

## 整体过程

1.不论用户想要登陆[教务系统](http://eams.uestc.edu.cn/eams)、[信息门户](http://portal.uestc.edu.cn/)还是[一卡通系统](http://ecard.uestc.edu.cn/)，都要通过[学校的统一认证门户](http://idas.uestc.edu.cn/authserver/login)。

2.首先get方法请求`http://idas.uestc.edu.cn/authserver/login`，获取得到的cookie，里面包含了本次会话所使用的JSESSIONID，如果不进行这一步直接进行身份认证，会因为没有会话ID产生302.

3.获取到会话ID之后，可以进行POST操作了，要注意的一点是，POST上传的数据不是简单的用户名和密码就好，需要携带一些特殊参数，这些参数都可以在网站上找到，是用hidden标签隐藏起来的。最终post的数据应该包含以下几个部分。

```json
{
    "username" : string,			//用户名
    "password" : string,			//密码
    "lt" : string,					//以下五个参数都可以从页面上获取。
    "dllt" : string,
    "execution" : string,
    "_eventId" : string,
    "rmShown" : int
}
```

4.携带之前的cookie将处理好的post数据上传，就可以得到用户标识符`iPlanetDirectoryPro` 和 `CASTGC` 了。

之后访问别的网页的时候，携带上这两个cookie就可以通过验证了。

## 代码实现

- ```php
  /**
   * 用于执行get请求
   * @author RioChen<283489710@qq.com>
   * @param $url是需要请求的url地址
   * @param $cookie_string是需要携带的cookie
   * @version 1.0
   */
  function get(string $url, string $cookie_string = '') : array
  {}
  ```
